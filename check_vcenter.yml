- name: Discover vCenter inventory
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Get datacenters
      community.vmware.vmware_datacenter_info:
        hostname: "{{ vcenter_hostname }}"
        username: "{{ vcenter_user }}"
        password: "{{ vcenter_password }}"
        validate_certs: no
      register: dc

    - name: Get clusters
      community.vmware.vmware_cluster_info:
        hostname: "{{ vcenter_hostname }}"
        username: "{{ vcenter_user }}"
        password: "{{ vcenter_password }}"
        validate_certs: no
      register: cluster

    - name: Show results
      debug:
        msg:
          - "Datacenters: {{ dc.datacenter_info | map(attribute='name') | list }}"
          - "Clusters: {{ cluster.clusters | map(attribute='cluster_name') | list }}"
          - "Networks: {{ net.networks | map(attribute='name') | list }}"
